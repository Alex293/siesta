<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Siesta  Reference</title>
    <link rel="stylesheet" type="text/css" href="css/jazzy.css" />
    <link rel="stylesheet" type="text/css" href="css/highlight.css" />
    <meta charset='utf-8'>
    <script src="js/jquery.min.js" defer></script>
    <script src="js/jazzy.js" defer></script>
  </head>
  <body>
    <a title="Siesta  Reference"></a>
    <header>
      <div class="content-wrapper">
        <p><a href="index.html">Siesta Docs</a> (54% documented)</p>
        <p class="header-right"><a href=""><img src="img/gh.png"/>View on GitHub</a></p>
      </div>
    </header>
    <div class="content-wrapper">
      <p id="breadcrumbs">
        <a href="index.html">Siesta Reference</a>
        <img id="carat" src="img/carat.png" />
        Siesta  Reference
      </p>
    </div>
    <div class="content-wrapper">
      <nav class="sidebar">
        <ul class="nav-groups">
          <li class="nav-group-name">
          <a href="Classes.html">Classes</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Classes/AlamofireTransportProvider.html">AlamofireTransportProvider</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Resource.html">Resource</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/ResourceStatusOverlay.html">ResourceStatusOverlay</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/Service.html">Service</a>
              </li>
              <li class="nav-group-task">
                <a href="Classes/TransformerSequence.html">TransformerSequence</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Global Variables.html">Global Variables</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Global Variables.html#/s:v6Siesta20enabledLogCategoriesGVSs3SetOS_11LogCategory_">enabledLogCategories</a>
              </li>
              <li class="nav-group-task">
                <a href="Global Variables.html#/s:v6Siesta6loggerFTOS_11LogCategorySS_T_">logger</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Enums.html">Enums</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Enums/LogCategory.html">LogCategory</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/RequestMethod.html">RequestMethod</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/ResourceEvent.html">ResourceEvent</a>
              </li>
              <li class="nav-group-task">
                <a href="Enums/Response.html">Response</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Protocols.html">Protocols</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Protocols.html#/s:P6Siesta17NSJSONConvertible">NSJSONConvertible</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/Request.html">Request</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/RequestTransport.html">RequestTransport</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ResourceObserver.html">ResourceObserver</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ResponseDataTransformer.html">ResponseDataTransformer</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/ResponseTransformer.html">ResponseTransformer</a>
              </li>
              <li class="nav-group-task">
                <a href="Protocols/TransportProvider.html">TransportProvider</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Structs.html">Structs</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Structs/JsonTransformer.html">JsonTransformer</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ResourceData.html">ResourceData</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/ResourceError.html">ResourceError</a>
              </li>
              <li class="nav-group-task">
                <a href="Structs/TextTransformer.html">TextTransformer</a>
              </li>
            </ul>
          </li>
          <li class="nav-group-name">
          <a href="Typealiases.html">Typealiases</a>
            <ul class="nav-group-tasks">
              <li class="nav-group-task">
                <a href="Typealiases.html#/s:6Siesta23ResourceObserverClosure">ResourceObserverClosure</a>
              </li>
            </ul>
          </li>
        </ul>
      </nav>
      <article class="main-content">
        <section>
          <section class="section">
            
            <a href='#siesta' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h1 id='siesta'>Siesta</h1>

<p>iOS REST Client Framework</p>

<p><strong>TL;DR</strong>: Drastically simplifies app code by providing a client-side cache of observable models for RESTful resources.</p>

<ul>
<li><strong>OS:</strong> iOS 8+</li>
<li><strong>Languages:</strong> Written in Swift, supports Swift and Objective-C</li>
<li><strong>Build requirements:</strong> Xcode 7 beta, Swift 2.0, Carthage</li>
<li><strong>License:</strong> MIT</li>
<li><strong>Status:</strong> Alpha, in active development. Works well, but API still in flux. Seeking feedback. Please experiment!</li>
</ul>

<!-- START doctoc generated TOC please keep comment here to allow auto update -->

<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

<p><strong>Table of Contents</strong></p>

<ul>
<li><a href="#what%E2%80%99s-it-for">What’s It For?</a>

<ul>
<li><a href="#the-problem">The Problem</a></li>
<li><a href="#the-solution">The Solution</a></li>
</ul></li>
<li><a href="#features">Features</a></li>
<li><a href="#design-philosophy">Design Philosophy</a></li>
<li><a href="#installation">Installation</a>

<ul>
<li><a href="#carthage">Carthage</a></li>
<li><a href="#cocoapods">CocoaPods</a></li>
</ul></li>
<li><a href="#basic-usage">Basic Usage</a></li>
<li><a href="#examples">Examples</a></li>
</ul>

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

<ul>
<li><a href="Docs/index.md">User Guide</a></li>
<li><a href="http://bustoutsolutions.github.io/siesta/api/">API Docs</a></li>
</ul>
<a href='#what_s_it_for' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='what_s_it_for'>What’s It For?</h2>
<a href='#the_problem' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='the_problem'>The Problem</h3>

<p>Want your app to talk to an API? Welcome to your state nightmare!</p>

<p>You need to display response data whenever it arrives, unless the requesting ViewController is no longer visible, unless some other currently visible ViewController happens to want the same data. You should show a loading indicator, display user-friendly errors (but no modal alert dogpiles!), give users a retry mechanism, and hide all that when a subsequent request succeeds. Be sure to avoid redundant requests. Oh, and remember not to retain your ViewController by accident in your callback closures.</p>

<p>What could possibly go wrong?</p>
<a href='#the_solution' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='the_solution'>The Solution</h3>

<p>Siesta ends this headache by providing an observable model of a RESTful resource’s state. The model answers three basic questions:</p>

<ul>
<li>What is the latest data for this resource, if any?</li>
<li>Did the latest request result in an error?</li>
<li>Is there a request in progress?</li>
</ul>

<p>…then provides notifications whenever the answers to these questions change.</p>

<p>Siesta handles all the transitions and corner cases to deliver these answers wrapped up with a pretty bow on top, letting you focus on your UI.</p>
<a href='#features' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='features'>Features</h2>

<ul>
<li>[x] Decouples UI component lifecycles from network request lifecycles</li>
<li>[x] Eliminates error-prone state tracking logic</li>
<li>[x] Eliminates redundant network requests</li>
<li>[x] Unified reporting for all errors: encoding, network, server-side, and parsing</li>
<li>[x] Transparent Etag / If-Modified-Since handling</li>
<li>[x] Painless handling for JSON and plain text, plus customizable response transformation</li>
<li>[x] Prebaked UI for loading &amp; error handling</li>
<li>[x] Uses <a href="https://github.com/Alamofire/Alamofire">Alamofire</a> for networking by default;
    inject a custom transport provider if you want to use a different networking library</li>
<li>[x] Thorough <a href="https://github.com/bustoutsolutions/siesta/tree/master/Tests">regression tests</a></li>
<li>[x] Debug-friendly, customizable logging</li>
<li>[x] Written in Swift with a great <a href="http://bustoutsolutions.github.io/siesta/api/">Swift-centric API</a>, but…</li>
<li>[x] …also works great from Objective-C thanks to a compatibility layer</li>
<li>[x] <a href="Docs/index.md">Documentation</a></li>
</ul>

<p><strong>Forthcoming:</strong></p>

<ul>
<li>[ ] Graceful handling for authenticated sessions</li>
<li>[ ] Intelligent progress reporting that accounts for request, latency, and response</li>
<li>[ ] Customizable data caching</li>
</ul>
<a href='#design_philosophy' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='design_philosophy'>Design Philosophy</h2>

<p>Make the default thing the right thing most of the time.</p>

<p>Make the right thing easy all of the time.</p>

<p>Build from need. Don’t invent solutions in search of problems.</p>

<p>Design the API with these goals:</p>

<ol>
<li>Make client code easy to <strong>read</strong>.</li>
<li>Make client code easy to <strong>write</strong>.</li>
<li>Keep the API clean.</li>
<li>Keep the implementation tidy.</li>
</ol>

<p><em>…in that order of priority.</em></p>
<a href='#installation' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='installation'>Installation</h2>

<p>We recommend adding Siesta to your project using Carthage. You can also manually build the framework yourself.</p>
<a href='#carthage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='carthage'>Carthage</h3>

<p><a href="https://github.com/Carthage/Carthage#installing-carthage">Install Carthage</a>.</p>

<p>Siesta requires Swift 2.0, so install the latest <a href="https://developer.apple.com/xcode/downloads/">Xcode 7 beta</a>, and point the command line tools at it:</p>
<pre class="highlight plaintext"><code>sudo xcode-select -s /Applications/Xcode-beta.app/Contents/Developer
</code></pre>

<p>Create a <code>Cartfile</code> in the root of your project if it don’t already exist, and add:</p>
<pre class="highlight plaintext"><code>github "bustoutsolutions/siesta" "master"
</code></pre>

<p>(Adding <code>master</code> keeps you on the bleeding edge, which is necessary until Siesta has an official release.)</p>

<p>Follow the <a href="https://github.com/Carthage/Carthage#adding-frameworks-to-an-application">Carthage instructions</a> to add <code>Siesta.framework</code> to your project.</p>

<p>As of this writing, there is one additional step you need to follow for Xcode 7 beta that isn’t in the Carthage docs:</p>

<ul>
<li>Build settings → Framework search paths → <code>$(PROJECT_DIR)/Carthage/Build/iOS/</code></li>
</ul>

<p>(In-depth discussion of Carthage on XC7 is <a href="https://github.com/Carthage/Carthage/issues/536">here</a>.)</p>

<p>Once you have the framework in your project, import Siesta and let the fun begin:</p>
<pre class="highlight swift"><code><span class="kd">import</span> <span class="kt">Siesta</span>
</code></pre>
<a href='#cocoapods' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h3 id='cocoapods'>CocoaPods</h3>

<p>We’ll add support when Xcode 7 goes out of beta (or sooner, if a suitable pull request should happen to roll in).</p>
<a href='#basic_usage' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='basic_usage'>Basic Usage</h2>

<p>Make a singleton for the REST API you want to use:</p>
<pre class="highlight swift"><code><span class="k">let</span> <span class="nv">MyAPI</span> <span class="o">=</span> <span class="kt">Service</span><span class="p">(</span><span class="nv">base</span><span class="p">:</span> <span class="s">"https://api.example.com"</span><span class="p">)</span>
</code></pre>

<p>Now register your view controller — or view, or anything you like — to receive notifications whenever the resource’s state changes:</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
    <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

    <span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">resource</span><span class="p">,</span> <span class="n">event</span> <span class="k">in</span>
        <span class="k">let</span> <span class="nv">json</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">dict</span>
        <span class="n">nameLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
        <span class="n">favoriteColorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">"favoriteColor"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>

        <span class="n">errorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">latestError</span><span class="p">?</span><span class="o">.</span><span class="n">userMessage</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Trigger a staleness-aware load when the view appears:</p>
<pre class="highlight swift"><code><span class="k">override</span> <span class="kd">func</span> <span class="nf">viewWillAppear</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
    <span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">loadIfNeeded</span><span class="p">()</span>
<span class="p">}</span>
</code></pre>

<p>…and you have a networked UI.</p>

<p>Add a loading indicator:</p>
<pre class="highlight swift"><code><span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">)</span> <span class="p">{</span> <span class="n">resource</span><span class="p">,</span> <span class="n">event</span> <span class="k">in</span>
    <span class="k">if</span> <span class="n">resource</span><span class="o">.</span><span class="n">loading</span> <span class="p">{</span>
        <span class="n">activityIndicator</span><span class="o">.</span><span class="nf">startAnimating</span><span class="p">()</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="n">activityIndicator</span><span class="o">.</span><span class="nf">stopAnimating</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>…or better yet, use Siesta’s prebaked UI component to get an activity indicator, a nicely formatted error message, and a retry button for free:</p>
<pre class="highlight swift"><code><span class="kd">class</span> <span class="kt">ProfileViewController</span><span class="p">:</span> <span class="kt">UIViewController</span><span class="p">,</span> <span class="kt">ResourceObserver</span> <span class="p">{</span>
    <span class="k">@IBOutlet</span> <span class="k">weak</span> <span class="k">var</span> <span class="nv">nameLabel</span><span class="p">,</span> <span class="nv">favoriteColorLabel</span><span class="p">:</span> <span class="kt">UILabel</span><span class="o">!</span>

    <span class="k">let</span> <span class="nv">statusOverlay</span> <span class="o">=</span> <span class="kt">ResourceStatusOverlay</span><span class="p">()</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLoad</span><span class="p">()</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewDidLoad</span><span class="p">()</span>

        <span class="n">statusOverlay</span><span class="o">.</span><span class="nf">embedIn</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>

        <span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="k">self</span><span class="p">)</span>
            <span class="o">.</span><span class="nf">addObserver</span><span class="p">(</span><span class="n">statusOverlay</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewDidLayoutSubviews</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">statusOverlay</span><span class="o">.</span><span class="nf">positionToCoverParent</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="k">override</span> <span class="kd">func</span> <span class="nf">viewWillAppear</span><span class="p">(</span><span class="nv">animated</span><span class="p">:</span> <span class="kt">Bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">super</span><span class="o">.</span><span class="nf">viewWillAppear</span><span class="p">(</span><span class="n">animated</span><span class="p">)</span>
        <span class="kt">MyAPI</span><span class="o">.</span><span class="nf">resource</span><span class="p">(</span><span class="s">"/profile"</span><span class="p">)</span><span class="o">.</span><span class="nf">loadIfNeeded</span><span class="p">()</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">resourceChanged</span><span class="p">(</span><span class="nv">resource</span><span class="p">:</span> <span class="kt">Resource</span><span class="p">,</span> <span class="nv">event</span><span class="p">:</span> <span class="kt">ResourceEvent</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="nv">json</span> <span class="o">=</span> <span class="n">resource</span><span class="o">.</span><span class="n">dict</span>
        <span class="n">nameLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">"name"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
        <span class="n">favoriteColorLabel</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">json</span><span class="p">[</span><span class="s">"favoriteColor"</span><span class="p">]</span> <span class="k">as?</span> <span class="kt">String</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre>

<p>Note that this is not just a toy example. Together with its storyboard, <strong>this small piece of code is a fully armed and operational REST-backed user interface</strong>, complete with an activity indicator, content-type-aware threaded parsing, robust error handling, refresh throttling, and app-wide response data sharing.</p>

<p>See the <a href="Docs/index.md">user guide</a> and <a href="http://bustoutsolutions.github.io/siesta/api/">API documentation</a> for more info.</p>
<a href='#examples' class='anchor' aria-hidden=true><span class="header-anchor"></span></a><h2 id='examples'>Examples</h2>

<p>This repo includes a <a href="Examples/GithubBrowser">simple example project</a>.</p>

          </section>
        </section>
        <section id="footer">
          <p>&copy; 2015 <a class="link" href="" target="_blank" rel="external"></a>. All rights reserved. (Last updated: 2015-08-08)</p>
          <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.2.2</a>, a <a class="link" href="http://realm.io" target="_blank" rel="external">Realm</a> project.</p>
        </section>
      </article>
    </div>
  </body>
</div>
</html>
